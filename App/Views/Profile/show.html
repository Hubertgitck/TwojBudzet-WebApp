{% extends 'base.html' %}

{% block title %}Ustawienia{% endblock %}

{% block css %}/Css/options.css{% endblock %}

{% block body %}
<div class="container-fluid">
    <div class="row">
        <header class="col-12 text-center text-uppercase fw-bold pt-2" id="logo" onclick="location.href='/';">
            <p> Twój budżet </p>
        </header>
    </div>

    <div class="row">
        <div class="col-12 w-75 m-auto accordion accordion-flush" id="accordionOptions">

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
                        aria-expanded="true" aria-controls="collapseOne">
                        Kategorie przychodów
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                    data-bs-parent="#accordionOptions">
                    <div class="accordion-body">
                        <table class="table">
                            <tbody id="incomes-tbody">

                            </tbody>
                        </table>
                        <div class="d-grid gap-2 col-6 mx-auto">
                            <button class="btn" type="button" id="add-category" name="add-category" data-bs-toggle="modal" data-bs-target="#incomesModal">
                            Dodaj kategorię</button>
                        </div>

                    </div>
                </div>



            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        Kategorie wydatków
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                    data-bs-parent="#accordionOptions">
                    <div class="accordion-body">
                        <table class="table">
                            <tbody id="expenses-tbody">

                            </tbody>
                        </table>
                        <div class="d-grid gap-2 col-6 mx-auto">
                            <button class="btn" type="button" id="add-category" name="add-category">Dodaj kategorię</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        Metody płatności
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                    data-bs-parent="#accordionOptions">
                    <div class="accordion-body">
                        <table class="table">
                            <tbody id="payment-methoods-tbody">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingFour">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        Użytkownik
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                    data-bs-parent="#accordionOptions">
                    <div class="accordion-body">
                        <table class="table">
                            <tbody id="user-tbody">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>

<div class="modal fade" id="incomesModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Dodaj kategorię</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-start">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Nazwa</label>
                        <input type="text" class="form-control" id="name" name="name" />
                    </div>

                    <div class="mb-3 form-check">
                        <label class="form-check-label" id="limit-checkbox-label"><input type="checkbox" class="form-check-input" id="limit-checkbox" onclick="enable_text(this.checked)" />Włącz limit</label>
                    </div>

                    <div class="mb-3">
                        <input type="number" class="form-control" id="limit" name="limit" disabled="disabled" placeholder="0,00zł" />
                    </div>

                    <div class="modal-footer d-block">
                        <button type="submit" class="btn btn-warning float-end">Dodaj</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>



{% endblock %}

{% block footer %}
<script src="/js/limits.js"></script>
<script>
    $("#limit-checkbox").click(function() {
        $("#limit").attr("disabled", !this.checked);
    });

    $(document).ready(function () {
    appendIncomesCategoriesToList();
    appendExpensesCategoriesToList();
});

async function appendIncomesCategoriesToList()
{
    url = "/api/getIncomesCategories";
    result = await getDataFromApi(url);

        for (let key in result){
            name = result[key].name;
            $("#incomes-tbody").append(rowMaker(name));
        }
    }

async function appendExpensesCategoriesToList()
{
    url = "/api/getExpensesCategories";
    result = await getDataFromApi(url);

        for (let key in result){
            name = result[key].name;
            $("#expenses-tbody").append(rowMaker(name));
        }
}

function rowMaker(name){
    let tr = document.createElement("tr");
        let tdCategory = document.createElement("td");
        let tdButtons = document.createElement("td");
        let li = document.createElement("li");
        let buttonEdit = document.createElement("button");
        let buttonDelete = document.createElement("button");
        let iconEdit = document.createElement("i");
        let iconDelete = document.createElement("i");

        tdCategory.textContent = name;
        li.className = 'list-inline-item';
        buttonEdit.className = 'btn btn-success btn-sm rounded-0';
        buttonEdit.type ='button';
        buttonEdit.setAttribute('data-toggle', 'tooltip');
        buttonEdit.setAttribute('data-placement','top');
        buttonEdit.title = 'Edytuj';

        buttonDelete.className = 'btn btn-danger btn-sm rounded-0 ms-1';
        buttonDelete.type ='button';
        buttonDelete.setAttribute('data-toggle', 'tooltip');
        buttonDelete.setAttribute('data-placement','top');
        buttonDelete.title = 'Usuń';
        iconEdit.className = 'fa fa-edit';
        iconDelete.className= 'fa fa-trash';

        buttonEdit.appendChild(iconEdit);
        buttonDelete.appendChild(iconDelete);

        li.append(buttonEdit);
        li.append(buttonDelete);
        tdButtons.append(li);
        tr.append(tdCategory);
        tr.append(tdButtons);

        return tr;
}
</script>




<!--
<main>
    <div class="container-fluid">
        <div class="row">
            <header class="col-12 text-center text-uppercase fw-bold pt-2" id="logo" onclick="location.href='/';">
                <p> Twój budżet </p>
            </header>

            <form class="col-12 text-center login-page-form" id="passwordForm" method="post" action="/profile/edit">
                <div class="login-page-field" id="username">
                    <label class="field-label" >Nazwa użytkownika</label>
                    <input disabled type="text" name="username" autofocus value="{{ user.username }}" required">
                </div>

                <div class=" login-page-field">
                    <label class="field-label">Adres e-mail</label>
                    <input disabled type="text" name="email" placeholder="adres@domena.pl" value="{{ user.email }}"  required>

                </div>

                {% for message in flash_messages %}
                <div id="added-succesfully" class="col-12 text-center p-2 mt-4 w-25 mx-auto alert alert-{{ message.type }}">
                    {{ message.body }}
                </div>
                {% endfor %}

                <div class="mt-5">
                    <button type="submit" class ="button"  id="loginButton"> Edytuj</button>
                    <input type="button" class ="button"  id="registerButton" onclick="location.href='/home'" value="Powrót">
                </div>

            </form>

        </div>
    </div>
</main>
-->
{% endblock %}
